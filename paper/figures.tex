\documentclass[a4paper,english]{report}

\include{rendering-preamble}

\usepackage{jpfigurecommands}
\include{tableread}

\begin{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Fig 0: 4.1 in thesis
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{tikzpicture}
\begin{groupplot}[
	group style={
		group size=3 by 1,
		horizontal sep=8pt,
	},
]

\nextgroupplot[
	%title=(a) Origin HTTP response codes,
	allDatasetsStackedXbar,
	allDatasetsXbar,
	allDatasetsXbarMiniResults,
	yticklabels={},
]

\XBarPlotFromDataset{\tableDatasetsRequestStatusCoverageOriginSortedSummary}{2xx}{2xx}{green}{}

\XBarPlotFromDataset{\tableDatasetsRequestStatusCoverageOriginSortedSummary}{3xx}{3xx}{yellow}{}

\XBarPlotFromDataset{\tableDatasetsRequestStatusCoverageOriginSortedSummary}{(null)}{(null)}{red}{}

\nextgroupplot[
	%title=(b) Origin redirects,
	allDatasetsStackedXbar,
	allDatasetsXbar,
	allDatasetsXbarMiniResults,
	yticklabels={},
	legend columns=2,
]

\XBarPlotFromDataset{\tableDatasetsNonFailedClassificationOriginRedirectsCoverageSortedSummary}{Sec}{Secure}{green}{}

\XBarPlotFromDataset{\tableDatasetsNonFailedClassificationOriginRedirectsCoverageSortedSummary}{Mix sec}{Mixed}{yellow}{}

\XBarPlotFromDataset{\tableDatasetsNonFailedClassificationOriginRedirectsCoverageSortedSummary}{Insec}{Insecure}{orange}{}

\XBarPlotFromDataset{\tableDatasetsNonFailedClassificationOriginRedirectsCoverageSortedSummary}{Mism}{Mismatch}{lightgray}{}

\nextgroupplot[
	%title=(c) Resource security,
	allDatasetsStackedXbar,
	allDatasetsXbar,
	allDatasetsXbarMiniResults,
        yticklabels={Top-10K global,Top-10K global (HTTPS), Top .se, Top .se (HTTPS), Rand-100K .se,Rand-100K .se (HTTPS),Municipal .se,Muni cipal .se (HTTPS)},
]

\XBarPlotFromDataset{\tableDatasetsNonFailedClassificationSecureCoverageSortedSummary}{All sec}{Secure}{green}{}

\XBarPlotFromDataset{\tableDatasetsNonFailedClassificationSecureCoverageSortedSummary}{Mix sec}{Mixed}{yellow}{}

\XBarPlotFromDataset{\tableDatasetsNonFailedClassificationSecureCoverageSortedSummary}{All insec}{Insecure}{orange}{}

\end{groupplot}
\end{tikzpicture}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Fig 1: 4.2 in thesis (NOT USED)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{tikzpicture}
\begin{groupplot}[
	group style={
		group size=3 by 1,
		horizontal sep=8pt,
	},
]

\nextgroupplot[
	title=(a) Resource distribution,
	allDatasetsStackedXbar,
	allDatasetsXbar,
	allDatasetsXbarMiniResults,
	yticklabels={},
]

\XBarPlotFromDataset{\tableDatasetsNonFailedClassificationDomainScopeCoverageSortedSummary}{Internal}{Internal}{green}{}

\XBarPlotFromDataset{\tableDatasetsNonFailedClassificationDomainScopeCoverageSortedSummary}{Mixed}{Mixed}{yellow}{}

\XBarPlotFromDataset{\tableDatasetsNonFailedClassificationDomainScopeCoverageSortedSummary}{External}{External}{orange}{}

\nextgroupplot[
	title=(b) Tracker categories,
	allDatasetsMultiXbar,
	allDatasetsXbar,
	allDatasetsXbarMiniResults,
	allDatasetsMultiXbarPart2,
	bar width=2.5pt,
	yticklabels={},
	legend columns=3,
]

\XBarPlotFromDataset{\tableDatasetsNonFailedDisconnectCategoriesCoverageExternalSortedSummary}{Any}{Any}{black!20!white}{bar shift=0pt, bar width=8.5pt}

\XBarPlotFromDataset{\tableDatasetsNonFailedDisconnectCategoriesCoverageExternalSortedSummary}{Disconnect}{Disconnect}{orange!80!white}{ultra thin, bar shift=3pt,}

\XBarPlotFromDataset{\tableDatasetsNonFailedDisconnectCategoriesCoverageExternalSortedSummary}{Content}{Content}{olive!80!white}{ultra thin, bar shift=1.5pt,}

\XBarPlotFromDataset{\tableDatasetsNonFailedDisconnectCategoriesCoverageExternalSortedSummary}{Advertising}{Advertising}{teal!80!white}{ultra thin, bar shift=0pt,}

\XBarPlotFromDataset{\tableDatasetsNonFailedDisconnectCategoriesCoverageExternalSortedSummary}{Analytics}{Analytics}{purple!80!white}{ultra thin, bar shift=-1.5pt,}

\XBarPlotFromDataset{\tableDatasetsNonFailedDisconnectCategoriesCoverageExternalSortedSummary}{Social}{Social}{brown!80!white}{ultra thin, bar shift=-3pt,}

\nextgroupplot[
	title=(c) Top organizations,
	allDatasetsMultiXbar,
	allDatasetsXbar,
	allDatasetsXbarMiniResults,
	allDatasetsMultiXbarPart2,
	bar width=2.5pt,
	yticklabels={alexa.top.10k-hw,alexa.top.10k-sw,alexa.top.se-hw,alexa.top.se-sw,se.r.100k-hw,se.r.100k-sw,se.hs.municip-hw,se.hs.municip-sw},
	legend columns=3,
]

\XBarPlotFromDataset{\tableDatasetsNonFailedDisconnectCategoriesCoverageExternalSortedSummary}{Any}{Any}{black!20!white}{bar shift=0pt, bar width=8.5pt}

\XBarPlotFromDataset{\tableDatasetsNonFailedDisconnectOrganizationsCoverageExternalSortedSummary}{Google}{Google}{red!90!white}{ultra thin, bar shift=2pt,}

\XBarPlotFromDataset{\tableDatasetsNonFailedDisconnectOrganizationsCoverageExternalSortedSummary}{Facebook}{Facebook}{blue!90!white}{ultra thin, bar shift=0pt,}

\XBarPlotFromDataset{\tableDatasetsNonFailedDisconnectOrganizationsCoverageExternalSortedSummary}{Twitter}{Twitter}{cyan!70!white}{ultra thin, bar shift=-2pt,}

\addplot+[
		stack plots=false,
		only marks,
		mark=x,
		mark size=3pt,
		fill=white,
		draw=black,
		semithick,
		fill opacity=1,
		update limits=false,
		line legend,
	]
	table[y=Dataset,x=Disconnect]
	\tableDatasetsNonFailedDisconnectCategoriesCoverageExternalSortedSummary;
\addlegendentry{Disconnect}

\end{groupplot}
\end{tikzpicture}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Fig 2: 4.3 in thesis (NOT USED)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{tikzpicture}
\begin{groupplot}[
	group style={
		group size=3 by 1,
		horizontal sep=8pt,
	},
]

\nextgroupplot[
	title=(a) Internal resources,
	datasetsCDF,
	datasetsCDFMiniResults,
	xlabel=Ratio of internal resources,
	ylabel=Ratio of domains,
]

	\CDFPlotFromDefaultDatasetsFile{datasets.non-failed.ratio-buckets.is-internal-domain.normalized.cumulative.sorted.tsv}

\legend{}

\nextgroupplot[
	title=(b) Secure resources,
	datasetsCDF,
	datasetsCDFMiniResults,
	xlabel=Ratio of secure resources,
	%ylabel=Ratio of domains,
	yticklabels={},
]

	\CDFPlotFromDefaultDatasetsFile{datasets.non-failed.ratio-buckets.is-secure.normalized.cumulative.sorted.tsv}

\legend{}

\nextgroupplot[
	title=(c) Disconnect's organizations,
	datasetsCDF,
	datasetsOccurances,
	datasetsOccurancesMiniResults,
	xlabel=Number of organizations,
	%ylabel=Ratio of domains,
	yticklabels={},
	legend columns=1,
	legend style={at={(1.025,.5)}, anchor=west},
]

	\CDFPlotFromDefaultDatasets{\tableTransposedDatasetsNonFailedRatioBucketsDisconnectOrganizationsNormalizedCumulativeSorted}

\legend{alexa.top.10k-hw,alexa.top.10k-sw,alexa.top.se-hw,alexa.top.se-sw,se.r.100k-hw,se.r.100k-sw,se.hs.municip-hw,se.hs.municip-sw}

\end{groupplot}
\end{tikzpicture}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Fig 3: modfied 4.3(a) from thesis
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{tikzpicture}
\begin{groupplot}[
        group style={
                group size=2 by 1,
                horizontal sep=8pt,
        },
]

\nextgroupplot[
        %title=(a) Internal resources,
        datasetsCDF,
        datasetsCDFMiniResults,
        xlabel=Ratio of internal resources,
        ylabel=Ratio of domains,
]

        \CDFPlotFromDefaultDatasetsFile{datasets.non-failed.ratio-buckets.is-internal-domain.normalized.cumulative.sorted.tsv}

\legend{Top-10K global, Top-10K global (HTTPS), Top .se, Top .se (HTTPS), Rand-100K .se,Rand-100K .se (HTTPS),Municipal .se, Municipal .se (HTTPS)}

\end{groupplot}
\end{tikzpicture}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Fig 4: NEW ...
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\end{document}
